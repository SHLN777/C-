<html>
<head>
  <title>1.函数式编程</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="659"/>
<h1>1.函数式编程</h1>

<div>
<span><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(173, 0, 0); font-weight: bold;">map</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">map()函数接收两个参数，一个是函数，一个是<b>Iterable</b></font></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">返回新的<b>Iterator</b></span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#147191" style="font-size: 12pt;">def f(x):</font></div><div><font color="#147191" style="font-size: 12pt;">    return x*x</font></div><div><font color="#147191" style="font-size: 12pt;">r = map(f, [1,2,3,4,6,7])</font></div><div><font color="#147191" style="font-size: 12pt;">list(r)</font></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">---&gt;[1,4,9,16,36,49]</span></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(173, 0, 0); font-weight: bold;">reduce</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">reduce把一个函数作用在一个序列[x1,x2,x3,x4x...]上，这个函数必须接收两个参数</font></div><div><font style="font-size: 12pt;">reduce把结果继续和序列的下一个元素做积累计算，其效果就是：</font></div><div><font style="font-size: 12pt;">    reduce(f,[x1,x2,x3,x4]) = f(f(f(x1, x2), x3), x4)</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#147191" style="font-size: 12pt;">from functools import reduce</font></div><div><font color="#147191" style="font-size: 12pt;"><br/></font></div><div><font color="#147191" style="font-size: 12pt;">def fn(x,y):</font></div><div><font color="#147191" style="font-size: 12pt;">    return x*10+y</font></div><div><font color="#147191" style="font-size: 12pt;">reduce(fn, [1,3,5,7,9])</font></div><div><br/></div><div><font style="font-size: 12pt;">---&gt;13579</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;"><b><font color="#1C3387">把str转换为int</font></b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font color="#147191" style="font-size: 12pt;">from functools import reduce</font></div><div><font color="#147191" style="font-size: 12pt;">def fn(x,y):</font></div><div><font color="#147191" style="font-size: 12pt;">    return x*10+y</font></div><div><font color="#147191" style="font-size: 12pt;">def char2num(s):</font></div><div><font color="#147191" style="font-size: 12pt;">    digits = {'0':0, '1':1, '2':2, '3':3, '4':4}</font></div><div><font color="#147191" style="font-size: 12pt;">    return digits[s]</font></div><div><font color="#147191" style="font-size: 12pt;">reduce(fn, map(char2num, '1234'))</font></div><div><br/></div><div><font style="font-size: 12pt;">---&gt;1234</font></div><div><br/></div><div><font style="font-size: 12pt;">reduce(lambda x,y:x*10+y, <font color="#E30000">map(char2num, '1234')</font>)</font></div></div><div><br/></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(173, 0, 0); font-weight: bold;">filter</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">filter()函数用于过滤序列，接收一个函数和一个序列</font></div><div><font style="font-size: 12pt;">和map()不同的是，filter()把传入的函数依次作用于每个元素</font></div><div><font style="font-size: 12pt;">然后根据返回值是True还是False决定保留还是放弃该元素</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#147191" style="font-size: 12pt;">def is_odd(n):</font></div><div><font color="#147191" style="font-size: 12pt;">    return n % 2 ==1</font></div><div><font color="#147191" style="font-size: 12pt;">list(filter(is_odd, [1,2,3,4,5,6,7,8,9]))</font></div><div><br/></div><div><font style="font-size: 12pt;">---&gt;[1,3,5,7,9]</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 14pt; color: rgb(173, 0, 0); font-weight: bold;">sorted(</span><span style="color: rgb(173, 0, 0); font-weight: bold; font-size: 12pt;">返回一个新列表</span><span style="font-size: 14pt; color: rgb(173, 0, 0); font-weight: bold;">)</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">默认从小到大</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font color="#E30000" style="font-size: 12pt;">sorted([], key=f, reverse=True)</font></div><div><font style="font-size: 12pt;">key指定的函数作用于list的每一个元素，并根据key函数的返回结果进行排序</font></div><div><font style="font-size: 12pt;">reverse从大到小排序</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#147191" style="font-size: 12pt;">list = [36,5,-12,9,-21]</font></div><div><font color="#147191" style="font-size: 12pt;">sorted(list, key=abs)</font></div><div><font style="font-size: 12pt;">---&gt;key之后[36,5,12,9,21]</font></div><div><font style="font-size: 12pt;">---&gt;最终排序[5,9,-12,-21,36]</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font color="#147191" style="font-size: 12pt;">sorted(['bob', 'about', 'Zoo', 'Credit'], key=str.lower)</font></div><div><font style="font-size: 12pt;">---&gt;['about', 'bob', 'Credit', 'Zoo']</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="color: rgb(227, 0, 0); font-size: 14pt;"><b>偏函数</b></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#147191" style="font-size: 12pt;">def int2(x, base=2):</font></div><div><font color="#147191" style="font-size: 12pt;"><span>    return int(x, base)</span><br/></font></div><div><font color="#147191" style="font-size: 12pt;"><span>int2('10000000')</span></font></div><div><font style="font-size: 12pt;"><span><br/></span></font></div><div><font style="font-size: 12pt;"><span>---&gt;64</span></font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#147191" style="font-size: 12pt;">import functools<br/></font></div><div><font color="#147191" style="font-size: 12pt;">int2 = functools.partial(int, base=2)</font></div><div><font color="#147191" style="font-size: 12pt;">int2('10000000')</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">---&gt;64</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div></span>
</div></body></html> 