<html>
<head>
  <title>8.账户管理</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="599"/>
<h1>8.账户管理</h1>

<div>
<span><div><div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">账户管理</span></font></div><div><span style="font-size: 10pt;"><br/></span></div><ul><li><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">在生产环境下操作数据库时，绝对不可以使用root账户连接，而是创建特定的账户，授予这个账户特定的操作权限，然后连接进行操作，主要的操作就是数据的crud</span></div></li><li><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">MySQL账户体系：根据账户所具有的权限的不同，MySQL的账户可以分为以下几种</span></div></li><ul><li><div>服务实例级账号：，启动了一个mysqld，即为一个数据库实例；如果某用户如root,拥有服务实例级分配的权限，那么该账号就可以删除所有的数据库、连同这些库中的表</div></li><li><div>数据库级别账号：对特定数据库执行增删改查的所有操作</div></li><li><div>数据表级别账号：对特定表执行增删改查等所有操作</div></li><li><div>字段级别的权限：对某些表的特定字段进行操作</div></li><li><div>存储程序级别的账号：对存储程序进行增删改查的操作</div></li></ul><li><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: &quot;Microsoft YaHei&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">账户的操作主要包括创建账户、删除账户、修改密码、授权权限等</span></div></li></ul><div><br/></div><div><span style="font-family: &quot;Microsoft YaHei&quot;;">注意：</span></div><ol><li><div>进行账户操作时，需要使用root账户登录，这个账户拥有最高的实例级权限</div></li><li><div>通常都使用数据库级操作权限</div></li></ol><div><br/></div></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">授予权限</span></font></div><div><br/></div><div>需要使用实例级账户登录后操作，以root为例</div><div><br/></div><div>主要操作：</div><ul><li><div>查看所有用户</div></li><li><div>修改密码</div></li><li><div>删除用户</div></li></ul><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(227, 0, 0); font-weight: bold;">1.查看所有用户</span></font></div><ul><li><div>所有用户及权限信息存储在mysql数据库的user表中</div></li><li><div>查看user表的结构</div></li><li><div>主要字段说明：</div></li><ul><li><div>Host表示允许访问的主机</div></li><li><div>User表示用户名</div></li><li><div>authentication_string表示密码，为加密后的值</div></li></ul></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>select host, user,authentication_string from user;</div></div><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(227, 0, 0); font-weight: bold;">2.创建账户、授权</span></font></div><ul><li><div>需要使用实例级账户登录操作，以root为例</div></li><li><div>常用权限主要包括：create、alter、drop、insert、update、delect、select</div></li><li><div>如果分配所有权限，可以使用all privileges</div></li></ul><div><br/></div><div><font style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold;">2.1创建账户&amp;授权</span></font></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>grant 权限列表 on 数据库 to '用户名'@'访问主机' identified by '密码';</div></div><div><br/></div><div><span style="color: rgb(54, 101, 238);">示例1</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>1.使用root登录</div><div>mysql -uroot -p</div><div><br/></div><div>2.创建账户并授予所有权限</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">grant </span> <span style="font-size: 9pt; font-family: Monaco;"><font color="#2D4FC9">select</font></span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">  on</span> <span style="font-size: 9pt; font-family: Monaco;"><font color="#2D4FC9">jing_dong</font></span> <span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">.*  to  'laowang'@'loacalhost'  </span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">identified by '123'</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-family: Monaco;"><font color="#2D4FC9" style="font-size: 12pt;">2.8.0以上版本</font></span></div><div><span style="font-family: Monaco;"><font color="#2D4FC9" style="font-size: 12pt;">先进入mysql数据库</font></span></div><div><span style="font-family: Monaco;"><font color="#2D4FC9" style="font-size: 12pt;">use mysql;</font></span></div><div><span style="font-family: Monaco;"><font color="#2D4FC9" style="font-size: 12pt;">create user '用户名'@'访问主机' identified by'新密码'；</font></span></div><div><span style="font-family: Monaco;"><font color="#2D4FC9" style="font-size: 12pt;">grant 权限列表 on 数据库.* to '用户名'@'访问主机'; (允许这个用户授权给其它用户 或 加新权限 with grant option)</font></span></div><div><span style="font-family: Monaco;"><font color="#2D4FC9" style="font-size: 12pt;"><br/></font></span></div><div><span style="color: rgb(45, 79, 201); font-family: Monaco;"><font style="font-size: 12pt;">再次修改，使用with grant option后</font></span></div><div><span style="color: rgb(45, 79, 201); font-family: Monaco;"><font style="font-size: 12pt;">刷新权限：flush privileges;</font></span></div></div><ul><li><div>可以操作python数据库的所有表，方式为：jing_dong.*</div></li><li><div>访问主机通常使用百分号%表示此账户可以使用任何ip的主机登录访问此数据库</div></li><li><div>访问主机可以设置成localhost或具体的ip，表示只允许本机或特定主机访问</div></li><li><div>查看用户有哪些权限</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>show grants for laowang@localhost</div></div><div><span style="font-size: 10pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>3.退出root的登录</div><div>quit</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">4.使用laowang账号登录</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">mysql  -ulaowang  -p</span></div></div><div><br/></div><div>所有权限设置</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>grant <font color="#2D4FC9">all privileges</font> on jing_dong.* to <font color="#2D4FC9">&quot;laoli&quot;@&quot;%&quot;</font> identified by &quot;12345678&quot;</div></div><div><br/></div><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(227, 0, 0); font-weight: bold;">3.修改密码</span></font></div><div><br/></div><div>使用root登录，修改mysql数据库的user表</div><ul><li><div>使用password()函数进行密码加密</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>updata user set authentication_string=password('新密码') where user='用户名';</div><div><br/></div><div>例：updata user set authentication_string=password('123') where user='xiaoming';</div></div><ul><li><div>注意修改完后需要刷新权限</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flush privileges</div></div><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(227, 0, 0); font-weight: bold;">4.远程登录</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>mysql -p172.1.1.1 -uxiao -p</div></div><div>不推荐，如果想远程登录，建议用ssh登录服务器</div><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(227, 0, 0); font-weight: bold;">5.删除账户</span></font></div><div><br/></div><div>语法一：使用root登录</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>drop user '用户名'@'主机';</div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">例：</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">drop user 'xiao'@'%';</span></div></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">语法二：使用root登录，删除mysql数据库的user表中数据</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>delete from user where user='用户名';</div><div><br/></div><div>例：</div><div>delete from user where user='xiao';</div></div><div><br/></div><div>操作结束之后需要刷新权限</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flush privileges</div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 