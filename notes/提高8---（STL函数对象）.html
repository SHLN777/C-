<html>
<head>
  <title>提高8---（STL函数对象）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="723"/>
<h1>提高8---（STL函数对象）</h1>

<div>
<span><div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">函数对象  </span></font></div><div><font style="font-size: 11pt;"> </font></div><div><span style="font-size: 11pt;">概念：</span></div><ul><li><div><span style="font-size: 11pt;">重载函数调用操作符的类，其对象常称为函数对象</span></div></li><li><div><span style="font-size: 11pt;">函数对象使用重载的（）时，行为类似函数调用，也叫仿函数</span></div></li></ul><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;">本质：函数对象（仿函数）是一个类，不是一个函数</span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;">使用特点：</span></div><ul><li><div><span style="font-size: 11pt;">函数对象在使用时，可以像普通函数那样调用，可以有参数，可以有返回值</span></div></li><li><div><span style="font-size: 11pt;">函数对象超出普通函数的概念，函数对象可以有自己的状态</span></div></li><li><div><span style="font-size: 11pt;">函数对象可以作为参数传递</span></div></li></ul><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;">函数对象在使用时，可以像普通函数那样调用，可以有参数，可以有返回值</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">class MyAdd</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">public:</font></div><div><font style="font-size: 11pt;">    int operator<b>()</b>(int v1, int v2)</font></div><div><font style="font-size: 11pt;">    {</font></div><div><font style="font-size: 11pt;">        return v1+v2;</font></div><div><font style="font-size: 11pt;">    </font><span style="font-size: 11pt;">}</span></div><div><font style="font-size: 11pt;">};</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">void test()</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">    MyAdd myadd;  //创建一个函数对象</font></div><div><font style="font-size: 11pt;">    cout&lt;&lt;myadd(10,10);</font></div><div><font style="font-size: 11pt;">}</font></div></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt;">函数对象超出普通函数的概念，函数对象可以有自己的状态</span></div><div><span style="font-size: 11pt;">普通函数没有这个能力，因为不是一个类，没有成员函数</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">class MyPrint</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">public:</font></div><div><font style="font-size: 11pt;">    MyPrint()</font></div><div><font style="font-size: 11pt;">    {</font></div><div><font style="font-size: 11pt;">        this-&gt;count = 0;</font></div><div><font style="font-size: 11pt;">    }</font></div><div><br/></div><div><font style="font-size: 11pt;">    int operator()(string test)</font></div><div><font style="font-size: 11pt;">    {</font></div><div><font style="font-size: 11pt;">        cout&lt;&lt;test&lt;&lt;endl;</font></div><div><font style="font-size: 11pt;">        this-&gt;count++;</font></div><div><font style="font-size: 11pt;">    }</font></div><div><span style="font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><font style="font-size: 11pt;">    int count;</font></div><div><font style="font-size: 11pt;">};</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">void test2()</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">    MyPrint myPrint;</font></div><div><font style="font-size: 11pt;">    myPrint(&quot;qwerdf&quot;)</font></div><div><font style="font-size: 11pt;">    cout&lt;&lt;myPrint.count&lt;&lt;endl;</font></div><div><font style="font-size: 11pt;">}</font></div></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt;">函数对象可以作为参数传递</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">void doPrint(MyPrint &amp;mp, string test)</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">    mp(test);</font></div><div><font style="font-size: 11pt;">}</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">void test3()</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">    MyPrint myPrint;</font></div><div><font style="font-size: 11pt;">    doPrint(myPrint, &quot;Hello World&quot;);</font></div><div><font style="font-size: 11pt;">}</font></div></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">谓词</span></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt;">概念：</span></div><ul><li><div><span style="font-size: 11pt;">返回bool类型的仿函数称为谓词</span></div></li><li><div><span style="font-size: 11pt;">如果operator()接受一个参数，叫一元谓词</span></div></li><li><div><span style="font-size: 11pt;">如果operator()接受两个参数，叫二元谓词</span></div></li></ul><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt;">一元谓词</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">class GreateFive</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">public:</font></div><div><font style="font-size: 11pt;">    bool operator()(int val)</font></div><div><font style="font-size: 11pt;">    {</font></div><div><font style="font-size: 11pt;">        return val &gt; 5;</font></div><div><font style="font-size: 11pt;">    }</font></div><div><font style="font-size: 11pt;">};</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">void test01()</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">    vector&lt;int&gt; v;</font></div><div><font style="font-size: 11pt;">    for(int i=0; i&lt;10; i++)</font></div><div><font style="font-size: 11pt;">    {</font></div><div><font style="font-size: 11pt;">        v.push_back(i);</font></div><div><font style="font-size: 11pt;">    </font><span style="font-size: 11pt;">}</span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;">    //查找容器中，有没有大于5的数字</span></div><div><span style="font-size: 11pt;">    //GreateFive()匿名函数对象</span></div><div><span style="font-size: 11pt;">    vector&lt;int&gt;::iterator it =find_if( v.begin(),v.end(),<font color="#E30000">GreatFive()</font> );</span></div><div><span style="font-size: 11pt;">    if(it == v.end())</span></div><div><span style="font-size: 11pt;">    {cout&lt;&lt;&quot;没找到！&quot;&lt;&lt;endl;}</span></div><div><font style="font-size: 11pt;">}</font></div></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt;">二元谓词</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">class MyCompare</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">public:</font></div><div><font style="font-size: 11pt;">    bool operator()(int val1, int val2)</font></div><div><font style="font-size: 11pt;">    {</font></div><div><font style="font-size: 11pt;">        return val1 &gt; val2;</font></div><div><font style="font-size: 11pt;">    }</font></div><div><font style="font-size: 11pt;">};</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">定义一个vector容器v</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">sort( v.begin(),v.end(),<font color="#E30000">MyCompare()</font> );</font></div></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font color="#E30000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">内建函数对象</span></font></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;">概念：STL内建了一些函数对象</span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;">分类：</span></div><ul><li><div><span style="font-size: 11pt;">算数仿函数</span></div></li><li><div><span style="font-size: 11pt;">关系仿函数</span></div></li><li><div><span style="font-size: 11pt;">逻辑仿函数</span></div></li></ul><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt;">用法：</span></div><ul><li><div><span style="font-size: 11pt;">这些仿函数所产生的对象，用法和一般函数完全相同</span></div></li><li><div><span style="font-size: 11pt;">使用内建函数对象，需要引入头文件 </span> <span style="font-size: 11pt; font-weight: bold;">#include&lt;functional&gt;</span></div></li></ul><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">算数仿函数</span></span></div><div><span style="font-size: 11pt;">功能：</span></div><ul><li><div><span style="font-size: 11pt;">实现四则运算</span></div></li><li><div><span style="font-size: 11pt;">其中negate是一元运算，其它是二元运算</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">template&lt;class   T&gt;   T    plus&lt;T&gt;    //加法仿函数</font></span></div><div><font style="font-size: 11pt;">template&lt;class T&gt; </font><font style="font-size: 11pt;"> T </font><font style="font-size: 11pt;"> minus&lt;T&gt;  //减法仿函数</font></div><div><font style="font-size: 11pt;">template&lt;class T&gt;  T  multiplies&lt;T&gt;  //乘法仿函数</font></div><div><font style="font-size: 11pt;">template&lt;class T&gt;  T  divides&lt;T&gt;  //除法仿函数</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">template&lt;class T&gt;  T  modulus&lt;T&gt;  //取模仿函数</font></div><div><font style="font-size: 11pt;">template&lt;class T&gt;  T  negate&lt;T&gt;  //取反仿函数</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">void test()</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">    <font color="#E30000">negate&lt;int&gt;n;</font></font></div><div><font color="#E30000" style="font-size: 11pt;">    cout&lt;&lt;n(50)&lt;&lt;endl;  //-50</font></div><div><br/></div><div><font color="#E30000" style="font-size: 11pt;">    plus&lt;int&gt;p;</font></div><div><font style="font-size: 11pt;"><font color="#E30000">    cout&lt;&lt;p(10,20)&lt;&lt;endl;  //30</font></font></div><div><font style="font-size: 11pt;">}</font></div></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">关系仿函数</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">template&lt;class T&gt; bool equal_to&lt;T&gt;  //等于</font></div><div><font style="font-size: 11pt;">template&lt;class T&gt; bool no_equal_to&lt;T&gt;  //不等于</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">template&lt;class T&gt; bool greater&lt;T&gt;  //大于</font></div><div><font style="font-size: 11pt;">template&lt;class T&gt; bool greater_equal&lt;T&gt;  //大于等于</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">template&lt;class T&gt; bool less&lt;T&gt;  //小于</font></div><div><font style="font-size: 11pt;">template&lt;class T&gt; bool less_equal&lt;T&gt;  //小于等于</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">void test()</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">    vector&lt;int&gt;v;</font></div><div><font style="font-size: 11pt;">    //排序，除了可以自己定义，还可以用内建函数对象</font></div><div><font style="font-size: 11pt;">    sort(v.begin(),v.end(), <font color="#E30000">greater&lt;int&gt;()</font>);</font></div><div><font style="font-size: 11pt;">}</font></div></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">逻辑仿函数</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">template&lt;class T&gt; bool logical_and&lt;T&gt;     //逻辑于</font></div><div><font style="font-size: 11pt;">template&lt;class T&gt; bool logical_or&lt;T&gt;     //逻辑或</font></div><div><font style="font-size: 11pt;">template&lt;class T&gt; bool logical_not&lt;T&gt;     //逻辑非</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">void test()</font></div><div><font style="font-size: 11pt;">{</font></div><div><font style="font-size: 11pt;">    vector&lt;bool&gt;v;</font></div><div><font style="font-size: 11pt;">    v.push_back(true);</font></div><div><font style="font-size: 11pt;">    v.push_back(flase);</font></div><div><font style="font-size: 11pt;">    v.push_back(true);</font></div><div><font style="font-size: 11pt;">    v.push_back(flase);</font></div><div><font style="font-size: 11pt;">    </font></div><div><font style="font-size: 11pt;">    vector&lt;bool&gt;v2;</font></div><div><font style="font-size: 11pt;">    v2.resize(v.size());</font></div><div><font style="font-size: 11pt;">    transform( v.begin(),v.end(), v2.begin(),logical_not&lt;bool&gt;() );</font></div><div><font style="font-size: 11pt;">}</font></div></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 