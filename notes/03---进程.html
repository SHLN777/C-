<html>
<head>
  <title>03---进程</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="885"/>
<h1>03---进程</h1>

<div>
<span><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">ulimit -a   查看进程可以使用的资源上限</font></div><div><font style="font-size: 12pt;">ulimit -n 4096   改变最大打开文件上限，软硬一起改，但不能超过硬限制数</font></div><div><font style="font-size: 12pt;">cat /proc/self/limits   查看详细的资源上限信息</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">设置的限制有两种： 硬限制和软限制</font></div><div><font style="font-size: 12pt;"><b>硬限制</b>是可以在任何时候任何进程中设置，但硬限制只能由超级用户提起</font></div><div><font style="font-size: 12pt;"><b>软限制</b>是内核实际执行的限制，任何进程都可以将软限制设置为任意小于等于对进程限制的硬限制的值</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">中断</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">中断就是一个硬件或软件请求，要求CPU暂停当前的工作，去处理更重要的事情。</font></div><div><font style="font-size: 12pt;">比如，在x86机器上可以通过int指令进行软件中断，而在磁盘完成读写操作后会向CPU发起硬件中断。</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">中断有两个重要的属性，<b>中断号</b>和<b>中断处理程序</b>。<b>中断号用来标识不同的中断，不同的中断具有不同的中断处理程序</b>。</font></div><div><font style="font-size: 12pt;">在操作系统内核中维护着一个中断向量表（Interrupt Vector Table），这个数组存储了所有中断处理程序的地址，</font></div><div><font style="font-size: 12pt;">而中断号就是相应中断在中断向量表中的偏移量。</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">虚拟内存</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">用户空间和内核空间</font></div><div><font style="font-size: 12pt;">都是虚拟地址，通过虚拟内存映射表，映射到物理内存</font></div><div><font style="font-size: 12pt;">每个进程都有自己独立的PCB，PCB在内核中，<font color="#FF0000">每个PCB都有一个指向文件表述符表的指针</font></font></div><div><font style="font-size: 12pt;">每个进程都分配有自己的虚拟空间</font></div><div><font style="font-size: 12pt;">CPU权限</font></div><div><span style="font-size: 12pt;">内存分配空间（page)，每个page对不同权限的CPU都有一个权限（例如读写等）</span></div><div><span style="font-size: 12pt;">TEXT：代码段</span></div><div><span style="font-size: 12pt;">每个进程都有很多环境变量（指定操作系统运行环境的一些参数） env命令可以查看</span></div></div><div><span style="font-size: 12pt;"><img src="03---进程_files/Image.png" type="image/png" data-filename="Image.png"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">用户空间</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">栈中的数据如果越界，会影响环境变量和命令行参数</font></div><div><font style="font-size: 12pt;">再往上就是内核空间</font></div></div><div><span style="font-size: 12pt;"><img src="03---进程_files/Image [1].png" type="image/png" data-filename="Image.png"/>                     </span><span style="font-size: 12pt;"><img src="03---进程_files/Image [2].png" type="image/png" data-filename="Image.png"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">进程环境</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">每个进程都有自己的环境</font></div><div><font style="font-size: 12pt;">libc:C标准库</font></div><div><font style="font-size: 12pt;">libc中定义的全局变量environ指向环境变量表，environ没有包含在任何头文件中，所 以在使用时要用extern声明。</font></div></div><div><font style="font-size: 12pt; color: rgb(20, 113, 145);">打印环境变量</font></div><div><span style="font-size: 12pt;"><img src="03---进程_files/Image [3].png" type="image/png" data-filename="Image.png"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">查看环境变量：echo $PATH<br/></font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div></span>
</div></body></html> 