<html>
<head>
  <title>数据分析---pandas</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="568"/>
<h1>数据分析---pandas</h1>

<div>
<span><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Series一维，带标签数组</span></div><div><span style="font-size: 12pt;">DataFrame二维，Series容器</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">创建</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">t = pd.Series([1,2,3,4,5])</font></div><div><font style="font-size: 12pt;">t = pd.Series([1,5,8,6,9],index=list(&quot;abcde&quot;))</font></div><div><font style="font-size: 12pt;">t = pd.Series(a,index=list(string.ascii_uppercase[5:15]))</font></div><div><font style="font-size: 12pt;">如果是字典，则键为索引</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">t.astype(float)</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">索引和切片</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">切片：直接传入start end或者步长即可</font></div><div><font style="font-size: 12pt;">索引：一个的时候直接传入序列号或者index,多个的时候传入序号或者index的列表</font></div><div><font style="font-size: 12pt;">t[2:10:2]</font></div><div><font style="font-size: 12pt;">t[[2,3,6]]</font></div><div><font style="font-size: 12pt;">t[&quot;F&quot;]、t[1]、t[[&quot;A&quot;,&quot;F&quot;,&quot;g&quot;]]</font></div></div><div><span style="font-size: 12pt;"><img src="数据分析---pandas_files/Image.png" type="image/png" data-filename="Image.png"/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">t.index  #获得索引，可迭代</font></div><div><font style="font-size: 12pt;">len(t.index)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">t.values</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">argmax,clip也可用于pandas</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">t.where(t&gt;2,2)</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">读取外部文件</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">pd.read_csv(&quot; .csv&quot;)</font></div><div><font style="font-size: 12pt;">pd.read_sql(sql_sentence,connection)</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">DataFrame</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">t = pd.DataFrame(np.arange(12).reshape((3,4)))</font></div><div><font style="font-size: 12pt;">t = pd.DataFrame(np.arange(12).reshape(3,4),index=list(&quot;abc&quot;),columns=list(&quot;wxyz&quot;))</font></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">行索引：index，axis=0</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">列索引：coulumns，axis=1</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">d1 = {&quot;name&quot;:[&quot;xiaoming&quot;,&quot;xiaogang&quot;],&quot;age&quot;:[20,32],&quot;tel&quot;:[10086,10010]}</font></div><div><font style="font-size: 12pt;">pd.DataFrame(d1)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">d2 = [{&quot;name&quot;:&quot;xiaoming&quot;,&quot;age&quot;:12,&quot;name&quot;:&quot;xiaohua&quot;,&quot;age&quot;:24}]</font></div><div><font style="font-size: 12pt;">pd.DataFrame(d2)</font></div></div><div><span style="font-size: 12pt;"><img src="数据分析---pandas_files/Image [1].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">描述信息</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">t.index</font></div><div><font style="font-size: 12pt;">t.columns</font></div><div><font style="font-size: 12pt;">t.values</font></div><div><font style="font-size: 12pt;">t.shape</font></div><div><font style="font-size: 12pt;">t.dtypes #列数据类型</font></div><div><font style="font-size: 12pt;">t.ndim #数据维度</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">t.head(m) #显示头几行</font></div><div><font style="font-size: 12pt;">t.tail(m) #显示后几行</font></div><div><font style="font-size: 12pt;">t.info() #相关信息概览：行数，列数，列索引，列类型等</font></div><div><font style="font-size: 12pt;">t.describe() #快速综合统计结果：计数，均值，标准差等</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">排序</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">t = t.sort_values( by=&quot; &quot;, ascending=Flase)  #按照列进行排序</span></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">取行或者列（读取的是Series、DataFrame类型数据）</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">方括号写数组，表示取行，对行进行操作</font></div><div><font style="font-size: 12pt;">写字符串，表示的取列索引，对列进行操作</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;"><b>通过标签索引行数据loc</b></span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><font style="font-size: 12pt;">t.loc[&quot;a&quot;,&quot;z&quot;] #取a行z列的数</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">t.loc[&quot;a&quot;,:] #a行</font></div><div><font style="font-size: 12pt;">t.loc[:,&quot;y&quot;] #y列</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">t.loc[[&quot;a&quot;,&quot;c&quot;]]  #取a行和c行   t.loc[[&quot;a&quot;,&quot;c&quot;],:]</font></div><div><font style="font-size: 12pt;">t.loc[:,[&quot;w&quot;,&quot;z&quot;]] #取w列和z列</font></div><div><font style="font-size: 12pt;">t.loc[[&quot;a&quot;,&quot;b&quot;],[&quot;w&quot;,&quot;z&quot;]] #取a行b行与w列z列的交叉数</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">t.loc[&quot;a&quot;:&quot;c&quot;,[&quot;w&quot;,&quot;z&quot;]] #a到c行，此时冒号是闭合的</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;"><b>通过位置获取行数据iloc</b></span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">t.iloc[1 , : ]</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">t.iloc[ : , [2,1] ]</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">t.iloc[1 : , : 2] = 3</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">t[t&gt;10]</font></div><div><font style="font-size: 12pt;">t[(t&gt;2)&amp;(t&lt;5)]  #不同条件之间需要用括号括起来</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">a = &quot;student&quot;</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">a.str.len()</span></div></div><div><span style="font-size: 12pt;"><img src="数据分析---pandas_files/Image [2].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">缺失数据处理</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 12pt;">数据缺失有两种情况：</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 12pt;">1.空，None等，在pandas是NaN</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 12pt;">2.0</font></span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 14pt;">判断</font></div><div><font style="font-size: 14pt;">pd.isnull(t)</font></div><div><font style="font-size: 14pt;">pd.notnull(t)</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">处理方式：</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">1.删除NaN所在的行列 dropna(axis=0, how='any', inplace=False)  #how:  &quot;all&quot;全为nan才删</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">2.填充数据，t.fillna(t.mean())，t.fialna(t.median())，t.fillna(0)</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">处理为0的数据：t[t==0] = np.nan</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">t[ pd.notnull(t[&quot;w&quot;]) ]   #w列不为null的行</span></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="color: rgb(173, 0, 0); font-size: 12pt; font-weight: bold;">常用统计方法</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">t[&quot;Rating&quot;].mean()</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">t[&quot;Actors&quot;].str.split(&quot;, &quot;).</span><span style="font-size: 12pt; font-family: Monaco;"><font color="#E30000">tolist()</font></span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">.max()</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">.min()</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">.argmax()</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">.argmin()</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">.median()</span></div></div><div><br/></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div></span>
</div></body></html> 