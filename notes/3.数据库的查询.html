<html>
<head>
  <title>3.数据库的查询</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="632"/>
<h1>3.数据库的查询</h1>

<div>
<span><div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">一、基本的查询</span></font></div><ul><li><div>可以用  .sql文件写指令，然后导入</div></li><li><div>基本准备</div></li><ol><li><div>创建一个数据库    （注：如果有'-'之类的要加“”， 如：&quot;python-1&quot;）</div></li><li><div>使用数据库</div></li><li><div>创建一个表</div></li><li><div>向表中插入数据</div></li><li><div>查询</div></li></ol></ul><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">二、条件查询</span></font></div><ol><li><div>比较运算符</div></li></ol><div style="margin-left: 80px;">&gt;  &lt;   &gt;=   &lt;=   !=</div><div style="margin-left: 80px;"><br/></div><div>       2.逻辑运算符</div><ul><ul><li><div>and         select * from student  <span style="color: rgb(227, 0, 0);">where age&gt;10 and age&lt;20</span> ; </div></li></ul><div>                                                              <span style="color: rgb(255, 0, 0);">where age&gt;10 and gender =&quot;nv&quot;;</span></div><ul><li><div>or            <span style="color: rgb(227, 0, 0);">where   age&gt;10  or  gender = &quot;nv&quot;</span>  符合一个就行       </div></li><li><div>not          <span style="color: rgb(227, 0, 0);">where  not( age&gt;18 and gender=2)</span> ; </div></li></ul></ul><div><br/></div><div>      3.模糊查询 （%替换一个或多个；_替换一个）      </div><ul><ul><li><div>like        select name from student  <span style="color: rgb(227, 0, 0);">where  name  like  &quot;小%&quot;</span> ;  以小开头的名字    </div></li></ul></ul><div>                                                                              <span style="color: rgb(227, 0, 0);">where  name  like  &quot;__&quot;</span> ;    查询两个字的名字</div><ul><ul><li><div>rlike 正则 select name from student  <span style="color: rgb(227, 0, 0);">where name rlike &quot;^周.*&quot;</span> ;  以周开头</div></li></ul></ul><div>                                                                                <span style="color: rgb(227, 0, 0);">where  name  rlike &quot;^周.*伦$&quot;</span> ;</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">三、范围查询</span></font></div><div><font style="font-size: 14pt;"><br/></font></div><ul><li><div>in (1,2,8) 表示在一个非连续的范围内</div></li><ul><li><div>select name , age  from  student  <span style="color: rgb(227, 0, 0);">where age in (12, 18, 34)</span> ;   </div></li></ul><li><div>not in () 不 非连续的范围内 </div></li><ul><li><div>     <span style="color: rgb(227, 0, 0);">where  age  not in (12, 18, 34)</span> ;  不是12,18,34的集合</div></li></ul><li><div>between ... and ... 表示在一个连续的范围内</div></li><ul><li><div>select * from student where age between 18 and 34 ;</div></li></ul><li><div>not  between ... and ... </div></li></ul><div><br/></div><div>        <font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(227, 0, 0); font-weight: bold;">空判断</span></font></div><div><span style="font-size: 12pt; color: rgb(227, 0, 0); font-weight: bold;">    </span><span style="font-size: 12pt; color: rgb(227, 0, 0); font-weight: bold;">       </span> <span style="font-size: 10pt;">is  null</span></div><div><span style="font-size: 10pt;">                         </span> <span style="font-size: 10pt; color: rgb(227, 0, 0);">  where height is null</span> <span style="font-size: 10pt;">;</span></div><div><span style="font-size: 10pt;">              is not null(判断非空</span><span style="font-size: 10pt;">)</span></div><div><span style="font-size: 10pt;"><br/></span></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">四、排序</span></font></div><div><font style="font-size: 10pt;"><br/></font></div><ul><li><div>order  by  字段</div></li><li><div>asc 升序    (默认)</div></li><li><div>desc 降序</div></li><ul><li><div>where (age between 18 and 34) and gender=1 <span style="color: rgb(227, 0, 0);">order by age</span></div></li><li><div>多个字段: where age between 18 and 34 and gender=1 <span style="color: rgb(227, 0, 0);">order by age desc , id desc</span> ;</div></li></ul></ul><div><span style="font-size: 10pt;"><br/></span></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">五、聚合、分组</span></font></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="color: rgb(227, 0, 0);">           聚合函数作用之后，只能显示一个结果，所以显示的字段就是聚合函数的名字</span></div><div><br/></div><ul><li><div>聚合函数 count </div></li><ul><li><div>selete  <span style="color: rgb(227, 0, 0);">count(*) </span> from  students  where gender=1 ; </div></li><li><div>selete  <span style="color: rgb(227, 0, 0);">count(*) as 男性</span>  from students  where gender=1 ;</div></li></ul><li><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">聚合函数max、min</span></div></li><ol><li><div>select  age from students ;</div></li><li><div>select  max(age)  from students ;</div></li><li><div>select  max(height) from students where gender=2 ;</div></li></ol><li><div>聚合函数sun、avg</div></li><ul><li><div>select sum(age) from students ;</div></li><li><div>select avg(age) from students ;</div></li><li><div>select <span style="color: rgb(227, 0, 0);">sum(age)/count(*)</span> from students ;</div></li></ul><li><div>聚合函数round</div></li><ul><li><div>select  <span style="color: rgb(227, 0, 0);">round(sum(age)/count(*) , 2)</span> from students ;</div></li></ul></ul><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">六、分组</span></font></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt; color: rgb(227, 0, 0); font-weight: bold;">            分组要和聚合在一起用</span></div><ul><li><div>select  gender  from students group by gender ;</div></li><li><div>select  <span style="color: rgb(227, 0, 0);">gender , count(*)</span> from students group by gender ;  在分的组里聚合</div></li><li><div>select  <span style="color: rgb(227, 0, 0);">gender , count(*)</span> from students where gender=1 group by gender ;  只看男性的总人数</div></li><li><div><span style="color: rgb(227, 0, 0);">group_concat(字段)</span>   看每组里面字段的内容</div></li><li><div>select  <span style="color: rgb(227, 0, 0);">gender , group_concat(name, age , id)</span> from students where gender=1 group by gender ;</div></li><li><div>select  <span style="color: rgb(227, 0, 0);">gender , group_concat(name, &quot;_&quot;, age, &quot;&quot; , id)</span> from students where gender=1 group by gender ;</div></li></ul><div><br/></div><ul><li><div>查询平均年龄超过30岁的性别，以及姓名  having  avg(age) &gt; 30</div></li><li><div>select gender, group_concat(name)， avg(age)  from students group by gender <span style="color: rgb(227, 0, 0);">having avg(age) &gt;30</span> ;</div></li><li><div><span style="color: rgb(173, 0, 0);">与where的区别：where是对原始表的条件， 而having是对查出来的结果的条件判断</span>；</div></li></ul><div><br/></div><div><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">七、分页</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt;">    limit  start, count</span></div><ul><li><div>限制查询出来的数据个数 select * from students where gender=1 <span style="color: rgb(227, 0, 0);">limit 2</span> ;</div></li><li><div>limit (第几页-1)*每页的个数，每页的个数 ; </div></li><li><div><span style="color: rgb(227, 0, 0);">limit必须放到最后</span>；</div></li></ul><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">八、链接查询</span></font></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;">    当查询结果的列来自多张表时，需要将多张表链接成一个大的数据集，再选择合适的列返回</span></div><div><span style="font-size: 10pt;">    MySQL支持三种类型的连接查询，分为：</span></div><div><span style="font-size: 10pt;">        内连接查询：查询的结果为两个表匹配到的数据</span></div><ul><ul><li><div><span style="font-size: 10pt;">select * from </span> <span style="font-size: 10pt; color: rgb(65, 0, 125);">表1</span> <span style="font-size: 10pt; color: rgb(227, 0, 0);">inner join</span> <span style="font-size: 10pt; color: rgb(65, 0, 125);">表2</span> <span style="font-size: 10pt; color: rgb(227, 0, 0);">on</span> <span style="font-size: 10pt; color: rgb(65, 0, 125);">表1.cls=表2.id</span> <span style="font-size: 10pt;">; </span></div></li><li><div><span style="font-size: 10pt;">select</span> <span style="font-size: 10pt; color: rgb(50, 135, 18);">表1.* , 表2.name</span><span style="font-size: 10pt;">  from </span> <span style="font-size: 10pt;">表1</span> <span style="font-size: 10pt;">inner join</span> <span style="font-size: 10pt;">表2</span> <span style="font-size: 10pt;">on</span> <span style="font-size: 10pt;">表1.cls=表2.id</span> <span style="font-size: 10pt;">; </span></div></li><li><div><span style="font-size: 10pt;">select</span> <span style="font-size: 10pt; color: rgb(50, 135, 18);">s.* , c.name</span><span style="font-size: 10pt;">  from </span> <span style="font-size: 10pt; color: rgb(65, 0, 125);">表1 as s</span> <span style="font-size: 10pt; color: rgb(227, 0, 0);">inner join</span> <span style="font-size: 10pt; color: rgb(65, 0, 125);">表2 as c</span> <span style="font-size: 10pt; color: rgb(227, 0, 0);">on </span> <span style="font-size: 10pt; color: rgb(65, 0, 125);">s.cls=c.id</span> <span style="font-size: 10pt;">; </span></div></li></ul></ul><div><span style="font-size: 10pt;">        左连接查询：(</span><span style="font-size: 10pt; color: rgb(255, 0, 0);">以左边的表为基准，到右边的表里去找，找不到用null代替</span><span style="font-size: 10pt;">)</span></div><ul><ul><li><div><span style="font-size: 10pt;">select * from 表1 as s</span> <span style="font-size: 10pt; color: rgb(227, 0, 0);">left join</span> <span style="font-size: 10pt;">表2</span> <span style="font-size: 10pt;">as</span> <span style="font-size: 10pt;">c</span> <span style="font-size: 10pt; color: rgb(227, 0, 0);">on</span> <span style="font-size: 10pt;">s.cls_id = c.id ;</span></div></li></ul></ul><div><span style="font-size: 10pt;">        右连接查询：right或把表调换一下</span></div><div><br/></div><div><span style="font-size: 10pt;">    在结果里取东西（用where也行）</span></div><div><span style="font-size: 10pt;">    </span><span style="font-size: 10pt;">select * from 表1 as s</span> <span style="font-size: 10pt;">left join</span> <span style="font-size: 10pt;">表2</span> <span style="font-size: 10pt;">as</span> <span style="font-size: 10pt;">c</span> <span style="font-size: 10pt;">on</span> <span style="font-size: 10pt;">s.cls_id = c.id </span> <span style="font-size: 10pt; color: rgb(227, 0, 0);">having  c,id is null</span> <span style="font-size: 10pt;">;</span></div><div><span style="font-size: 10pt;"><br/></span></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">八、自关联</span></font></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;">select * from</span> <span style="font-size: 10pt; color: rgb(227, 0, 0);">表 as p</span> <span style="font-size: 10pt;">inner join</span> <span style="font-size: 10pt; color: rgb(227, 0, 0);">表 as c</span> <span style="font-size: 10pt;">on</span> <span style="font-size: 10pt; color: rgb(65, 0, 125);">p.aid=c.pid</span> <span style="font-size: 10pt;">having p.atitle=&quot;山东&quot; ;</span></div><div><font style="font-size: 11px;"><span style="font-size: 10pt;"><br/></span></font></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">九、子查询</span></font></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;">    select里嵌着一个子查询</span></div><div><span style="font-size: 10pt;">    select * from students where height=</span><span style="font-size: 10pt; color: rgb(227, 0, 0);">(select max(height) from students)</span> <span style="font-size: 10pt;">;</span></div><ul><li><div>列级子查询</div></li><li><div>行级子查询</div></li><li><div>表级子查询</div></li></ul><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">去重</span>：select  distinct  name  from students ; </div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 14pt;"><br/></span></div><div style="margin-left: 40px;"><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><font style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 10pt;"><br/></font></div><div><font style="font-size: 10pt;"><br/></font></div></div><div><br/></div></span>
</div></body></html> 