<html>
<head>
  <title>01---特征提取</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="590"/>
<h1>01---特征提取</h1>

<div>
<span><div><span style="font-size: 11pt;">机器学习是从</span><span style="font-size: 11pt; color: rgb(227, 0, 0);">数据</span><span style="font-size: 11pt;">中自动分析获得</span><span style="font-size: 11pt; color: rgb(227, 0, 0);">规律（模型）</span><span style="font-size: 11pt;">，并利用规律对</span><span style="font-size: 11pt; color: rgb(227, 0, 0);">未知数据进行预测</span></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt;">机器学习的数据：文件CSV</span></div><div><span style="font-size: 11pt;">mysql的缺陷：1、性能瓶颈，读取速度</span></div><div><span style="font-size: 11pt;">                       2、格式不太符合机器学习要求数据的格式</span></div><div><span style="font-size: 11pt;">pandas：读取工具，基本的处理格式的工具</span></div><div><span style="font-size: 11pt;">numpy：释放GIL锁，真正的多线程</span></div><div><br/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">可用数据集</font></div><div><font style="font-size: 11pt;">数据结构：特征值+目标值</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">sklearn</font></div><div><font style="font-size: 11pt;">UCI</font></div><div><font style="font-size: 11pt;">kaggle</font></div></div><div><br/></div><div><br/></div><div><font style="font-size: 14pt; color: rgb(227, 0, 0);"><b>特征抽取</b></font></div><div><font style="font-size: 14pt; color: rgb(227, 0, 0);"><b><br/></b></font></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;"><b>特征抽取</b></font><font style="font-size: 11pt;">（特征抽取对文本等数据进行特征值化）</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">from sklearn.feature_extraction.text import CountVectorizer</font></div><div><font style="font-size: 11pt;">vector = CountVectorizer()</font></div><div><font style="font-size: 11pt;">res = vector.fit_transform([&quot;life is short,i love python&quot;,&quot;life is so long&quot;])</font></div><div><font style="font-size: 11pt;">print(vector.get_feature_names())</font></div><div><font style="font-size: 11pt;">print(res.toarray())</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;"><b><font color="#E30000">字典特征抽取</font></b><br/></font></div><div><font style="font-size: 11pt;"><b><br/></b></font></div><div><font style="font-size: 11pt;">作用：对字典数据进行特征抽取</font></div><div><font style="font-size: 11pt;">类：sklearn.feature_extraction.DictVectorizer</font></div></div><div><span style="font-size: 11pt;"><img src="01---特征提取_files/Image.png" type="image/png" data-filename="Image.png"/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">流程：</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">1.实例化类DictVectorizer</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">2.调用fit_transform方法输入数据并转换    注意返回格式</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">字典要放到列表里</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">[ {'city':'北京'，'temperature':100}</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;"> {'city':'上海'，'temperature':60} ]</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#147191" style="font-size: 12pt;">dict = DictVectorizer()  //sparse = false 不返回数组，返回矩阵<br/></font></div><div><font color="#147191" style="font-size: 12pt;"><font>data = dict.fit_transform(</font>[ {'city':'北京'，'temperature':100},{'city':'上海'，'temperature':60} ]<font>)</font></font></div><div><font style="font-size: 12pt;"><font><font color="#147191">print(data)</font>   //返回sparse矩阵</font></font></div></div><div><span style="font-size: 11pt;"><img src="01---特征提取_files/Image [1].png" type="image/png" data-filename="Image.png" width="393"/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">字典数据抽取：把字典中一些类别数据，分别进行转换成特征</span></div><div><font style="font-size: 12pt;">dict.get_feature_names() <br/></font></div><div><font style="font-size: 12pt;">['city=上海','city=北京','temperature']</font></div></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 12pt; color: rgb(227, 0, 0);"><b>文本特征抽取</b></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">作用：对文本数据进行特征值化</font></div><div><font style="font-size: 12pt;">类：sklearn.feature_extraction.text.countVectorizer</font></div></div><div><span style="font-size: 11pt;"><img src="01---特征提取_files/Image [2].png" type="image/png" data-filename="Image.png"/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#147191" style="font-size: 12pt;">from sklearn.feature_extraction.text import CountVectorizer</font></div><div><font color="#147191" style="font-size: 12pt;">vector = CountVectorizer()  //sparse = false</font></div><div><font color="#147191" style="font-size: 12pt;">res = vector.fit_transform([&quot;life is short,i love python&quot;,&quot;life is so long&quot;])</font></div><div><font color="#147191" style="font-size: 12pt;">print(res)</font></div><div><font color="#147191" style="font-size: 12pt;">print(res.toarray()) //把sparse转换成narray</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">中文文本</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">下载：pip3 install jieba</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">使用：import jieba</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">          jieba.cut(&quot;我是一个&quot;)</span></div><div><span style="font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco;">返回值：词语生成器，可以转换成列表,在转换成字符串（' '.join( )）</span></div></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 12pt; color: rgb(227, 0, 0);"><b>tf-df</b></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div style="font-size: 12pt;"><font size="1"><font color="#000000">TF-IDF的主要思想是：如果某个词或短语在一篇文章中出现的概率高，并且在其他文章中很少出现，<br/></font></font></div><div style="font-size: 12pt;"><font size="1"><font color="#000000">则认为此词或者短语具有很好的类别区分能力，适合用来分类。</font></font></div><div style="font-size: 12pt;"><font size="1"><font color="#000000">TF-IDF作用：用以评估一字词对于一个文件集或一个语料库中的其中一份文件的</font><font color="#E30000">重要程度</font></font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">tf:term frequency(词的频率)<br/></font></div><div><font style="font-size: 12pt;">idf:inverse document frequency（逆文档频率） log(总文档数量/该词出现的文档数量)</font></div><div><font style="font-size: 12pt;">tf*idf：重要性程度</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">sklearn.feature_extraction.text.TfidfVectorizer<br/></font></div></div><div><span style="font-size: 11pt;"><img src="01---特征提取_files/Image [3].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 11pt;"> </span><br/></div><div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">tf.TfidfVectorizer()</font></div><div><font style="font-size: 12pt;">data = tf.fit_transform([c1,c2,c3])<br/></font></div><div><font style="font-size: 12pt;">print(data.toarray()) // 返回三个array数组，每个数组中 每个单词对应一个值，值越大越重要</font></div></div><br/></div><div><span style="font-size: 11pt;"><br/></span></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><br/></div></span>
</div></body></html> 