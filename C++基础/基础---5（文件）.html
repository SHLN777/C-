<html>
<head>
  <title>基础---5（文件）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="617"/>
<h1>基础---5（文件）</h1>

<div>
<span><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">一、文件</span></font></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt;">程序运行时产生的数据都属于临时数据，程序一旦运行结束都会被释放</span></div><div><span style="font-size: 10pt;">通过文件可以将数据持久化</span></div><div><span style="font-size: 10pt;">C++中对文件操作需要包含头文件</span> <span style="font-size: 10pt; color: rgb(255, 0, 0);">&lt;fstream&gt;</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(255, 0, 0);">默认以文本文件方式输入输出</span></font></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">ios::trunc    如果文件存在先删除，再创建</font></span></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><b><font style="font-size: 12pt;">文本文件</font></b></span></div><div><span style="font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">#include &lt;fstream&gt;</font></span></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">ifstream  ifs;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">ifs.open(&quot;test.txt&quot;, ios::in);</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">if( !ifs.is_open() )</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">{ </font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    cout&lt;&lt;&quot; 打开失败&quot;&lt;&lt;endl;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    return;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">}</font></span></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">//读数据1</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">char buf[1024] = {0};</font></span></div><div><span style="font-family: Monaco;"><font style="font-size: 11pt;">while(ifs &gt;&gt; buf)   //<font color="#E30000">读完会返回0</font></font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">{</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    cout&lt;&lt;buf&lt;&lt;endl;  //不同 cout&lt;&lt; 有运算符重载，输出不一样</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">}<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    //对字符型，直接通过数组名输出数组全部值</span></font></span></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">//读数据2</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">char  buf[1024] = {0};</font></span></div><div><span style="font-family: Monaco;"><font style="font-size: 11pt;">while( <font color="#E30000">ifs.getline(buf, sizeof(buf)) </font>)</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">{</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    cout&lt;&lt;buf&lt;&lt;endl;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">}</font></span></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">//读数据3</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">sting buf;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">while( getline(ifs, buf) )</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">{</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    cout&lt;&lt;buf&lt;&lt;endl;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">}</font></span></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">//读数据4</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">char c;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">while( ( c=ifs.get() ) != EOF )  //EOF  end of file</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">{</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    cout&lt;&lt;c; </font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">}</font></span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco;"><font color="#1C3387" style="font-size: 12pt;">getline()</font></span></div><div><br/></div><div><span style="font-family: Monaco;"><font color="#1C3387" style="font-size: 12pt;">1.在&lt;iostream&gt;中</font></span></div><div><br/></div><div><font color="#1C3387" style="font-size: 12pt;">istream&amp; getline (char* s, streamsize n );</font></div><div><font color="#1C3387" style="font-size: 12pt;">istream&amp; getline (char* s, streamsize n, char delim );</font></div><div><span style="font-size: 12pt; color: rgb(28, 51, 135); font-family: Monaco;">从istream中读取至多n个字符（包含结束标识符）保存在s对应的数组</span></div><div><span style="font-size: 12pt; color: rgb(28, 51, 135); font-family: Monaco;">中。即使还没读够n个字符，如果遇到delim或字数达到限制，则终止，</span></div><div><span style="font-size: 12pt; color: rgb(28, 51, 135); font-family: Monaco;">delim都不会被保存进对应的数组中。</span></div><div><span style="font-size: 12pt; color: rgb(28, 51, 135); font-family: Monaco;">cin.getline(wolds, 256);</span></div><div><span style="font-size: 12pt; color: rgb(28, 51, 135); font-family: Monaco;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(28, 51, 135); font-family: Monaco;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(28, 51, 135); font-family: Monaco;">2.在&lt;string&gt;中的getline函数有四种重载形式</span></div><div><span style="font-size: 12pt; color: rgb(28, 51, 135); font-family: Monaco;"><br/></span></div><div><font color="#1C3387" style="font-size: 12pt;">istream&amp; getline (istream&amp;  is, string&amp; str, char delim);</font></div><div><font color="#1C3387" style="font-size: 12pt;">istream&amp; getline (istream&amp;&amp; is, string&amp; str, char delim);</font></div><div><font color="#1C3387" style="font-size: 12pt;">istream&amp; getline (istream&amp;  is, string&amp; str);</font></div><div><font color="#1C3387" style="font-size: 12pt;">istream&amp; getline (istream&amp;&amp; is, string&amp; str);</font></div><div><font color="#1C3387" style="font-size: 12pt;">用法和上第一种类似，但是读取的istream是作为参数is传进函数的。</font></div><div><font color="#1C3387" style="font-size: 12pt;">读取的字符串保存在string类型的str中。</font><span style="font-size: 12pt; color: rgb(28, 51, 135);">函数的变量：</span></div><div><font color="#1C3387" style="font-size: 12pt;">is    ：表示一个输入流，例如 cin。</font></div><div><font color="#1C3387" style="font-size: 12pt;">str   ：string类型的引用，用来存储输入流中的流信息。</font></div><div><font color="#1C3387" style="font-size: 12pt;">delim ：char类型的变量，所设置的截断字符；在不自定义设置的情况下，遇到’\n’，则终止输入。</font></div><div><span style="font-size: 12pt; color: rgb(28, 51, 135); font-family: Monaco;">getline(cin, str);</span></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 12pt;"><b>二进制文件</b></font></span></div><div><span style="font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco;">打开方式要指定为 ios::binary</span></div><div><span style="font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco;">二进制方式写文件主要利用流对象调用成员函数</span><span style="font-size: 11pt; font-family: Monaco;"><font color="#E30000">write</font></span></div><div><span style="font-size: 11pt; font-family: Monaco;"><font color="#E30000">函数原型：ostream&amp;  write(const  cahr * buffer , int  len);</font></span></div><div><span style="font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco;">参数解释：字符指针buffer指向内存中一段存储空间。len是读写的字节数</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">class Person</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">{</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">public:</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    char name[64];</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    int age;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">}; </font></span></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">void test()</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">{</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    ofstream  ofs;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    ofs.open(&quot;person.txt&quot;, ios::out | ios::binary);</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    Person p = {&quot;xiao&quot;, 18};</font></span></div><div><span style="font-family: Monaco;"><font style="font-size: 11pt;">    <font color="#E30000">ofs.write( (const char *)&amp;p, sizeof(Person) );</font></font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    ofs.close();</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">}</font></span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco;"><font style="font-size: 11pt;">二进制方式读文件主要利用流对象调用成员函数<font color="#E30000">read</font></font></span></div><div><span style="font-family: Monaco;"><font color="#E30000" style="font-size: 11pt;">函数原型：istream&amp;  read(char *buffer, int len);</font></span></div><div><span style="font-size: 11pt; font-family: Monaco;">参数解释：字符指针buffer指向内存中一段存储空间，len是读写的字节数</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">ifstream  ifs;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">ifs.open(</font></span><font style="font-size: 11pt;">&quot;person.txt&quot;, ios::in | ios::binary</font><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">)</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">if( !ifs.is_open() )</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">{</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    cout&lt;&lt;&quot;失败！&quot;;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">    return;</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">}</font></span></div><div><span style="color: rgb(51, 51, 51); font-family: Monaco;"><font style="font-size: 11pt;">Person p;</font></span></div><div><span style="font-family: Monaco;"><font color="#E30000" style="font-size: 11pt;">ifs.read( (char *)&amp;p, sizeof(Person) );</font></span></div><div><span style="font-family: Monaco;"><font color="#E30000" style="font-size: 11pt;">cout&lt;&lt;p.name;</font></span></div></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt;"><br/></span></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 